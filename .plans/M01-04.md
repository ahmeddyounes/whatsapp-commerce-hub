# M01-04 â€” Interactive Message Response Parser

Create parser for handling interactive message responses from customers. Create class WCH_Response_Parser with method parse($webhook_message_data) returning WCH_Parsed_Response object. WCH_Parsed_Response properties: type (text/button_reply/list_reply/product_inquiry/location/image/document/unknown), raw_content, parsed_data array. For text messages: extract text body, detect intent keywords (hi/hello=greeting, order/track=order_status, help/support=help, cart/basket=view_cart, checkout/pay=checkout, cancel=cancel). For interactive button_reply: extract button_id and button_title. For interactive list_reply: extract list_id, title, description. For product inquiry (nfm_reply): extract product_retailer_id, catalog_id. For location: extract latitude, longitude, name, address. For image/document: extract media_id, mime_type, sha256, caption. Create intent detection method detect_intent($text) using keyword matching and optional AI enhancement. Intents enum: GREETING, BROWSE_CATALOG, VIEW_CATEGORY, SEARCH_PRODUCT, VIEW_PRODUCT, ADD_TO_CART, VIEW_CART, MODIFY_CART, CHECKOUT, APPLY_COUPON, ORDER_STATUS, TRACK_SHIPPING, HELP, TALK_TO_HUMAN, UNKNOWN. Store parsed response in conversation context for multi-turn handling. Add filter 'wch_parse_response' for custom parsing extensions. Acceptance criteria: All WhatsApp message types parsed correctly, intents detected accurately for common phrases, unknown intents gracefully handled, parser is extensible via filters.
