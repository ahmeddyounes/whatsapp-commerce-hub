# M00-06 â€” Background Job Queue Processor

Create async job processing system for long-running tasks. Create class WCH_Queue using Action Scheduler (bundled with WooCommerce). Register action hooks on init: 'wch_process_sync_job', 'wch_send_broadcast_batch', 'wch_cleanup_expired_carts', 'wch_process_abandoned_cart', 'wch_retry_failed_message'. Create WCH_Job_Dispatcher with methods: dispatch($hook, $args, $delay_seconds), dispatch_batch($hook, $items_array, $batch_size), cancel($hook, $args), is_scheduled($hook, $args), get_pending_count($hook). Job handlers to implement: WCH_Sync_Job_Handler for product/order sync with retry logic (max 3 attempts, exponential backoff 60s/300s/900s). WCH_Broadcast_Job_Handler processes broadcast campaigns in batches of 50 recipients with 1 second delay between batches to respect rate limits. WCH_Cart_Cleanup_Handler runs hourly via wch_hourly_cron to delete carts older than 72 hours. WCH_Abandoned_Cart_Handler sends reminder messages for carts idle for configured hours. Create admin UI in Settings > Advanced showing: pending jobs count by type, failed jobs list with retry button, job processing status. Store job results in wch_job_results transient for 1 hour. Acceptance criteria: Jobs process reliably in background, failed jobs retry with backoff, rate limits respected, admin can monitor and retry jobs, no memory exhaustion on large batches.
